{"title":"CoPP","markdown":{"yaml":{"title":"CoPP","format":{"html":{"toc":true,"toc-depth":5,"css":"styles.css"}},"editor_options":{"markdown":{"mode":"gfm"}}},"headingText":"General Notes","containsRefs":false,"markdown":"\n\n\n- Stands for **Control Plane Policing**\n- Used to protect the control plane of network equipment from being saturated with less preferred traffic, DOS attempts, etc\n- Policy-maps function in top-down fashion like ACLs\n- `class-default` will match all traffic not matched earlier in a policy-map\n- **Match any vs Match all**\n\t- Used in class-maps, behavior differenet when matching multiple access groups\n\t- Match any functions as boolean **OR**, match all functions as boolean **AND**\n\t\n---\n\n#### Useful show commands\n- `show policy-map control-plane input` - Verify number of packets hitting COPP policy\n\n---\n\n#### Standard CoPP Config\n```\n! Identify traffic with ACLs\n!\nip access-list extended COPP-ICMP-ACL-EXAMPLE\n permit udp any any range 33434 33463 ttl eq 1\n permit icmp any any unreachable\n permit icmp any any echo\n permit icmp any any echo-reply\n permit icmp any any ttl-exceeded\n exit\nip access-list extended COPP-MGMT-TRAFFIC-ACL-EXAMPLE\n permit udp any eq ntp any\n permit udp any any eq snmp\n permit tcp any any eq 22\n permit tcp any eq 22 any established\n permit tcp any any eq 23\n exit\nip access-list extended COPP-ROUTING-PROTOCOLS-ACL-EXAMPLE\n permit tcp any eq bgp any established\n permit eigrp any host 224.0.0.10\n permit ospf any host 224.0.0.5\n permit ospf any host 224.0.0.6\n permit pim any host 224.0.0.13\n permit igmp any any\n!\n! Create class maps to define traffic classes\n!\nclass-map match-all COPP-ICMP-CLASSMAP-EXAMPLE\n match access-group name COPP-ICMP-ACL-EXAMPLE\nclass-map match-all COPP-MGMT-TRAFFIC-CLASSMAP-EXAMPLE\n match access-group name COPP-MGMT-TRAFFIC-ACL-EXAMPLE\nclass-map match-all COPP-ROUTING-PROTOCOLS-CLASSMAP-EXAMPLE\n match access-group name COPP-ROUTING-PROTOCOLS-ACL-EXAMPLE\n!\n! Create policy map to define service policy\n!\npolicy-map COPP-POLICYMAP-EXAMPLE\n class COPP-MGMT-TRAFFIC-CLASSMAP-EXAMPLE\n  police 32000 conform-action transmit exceed-action transmit violate-action transmit\n class COPP-ROUTING-PROTOCOLS-CLASSMAP-EXAMPLE\n  police 34000 conform-action transmit exceed-action transmit violate-action transmit\n class COPP-ICMP-CLASSMAP-EXAMPLE\n  police 8000 conform-action transmit exceed-action transmit violate-action drop\n!\n! Apply policy to control plane\n!\ncontrol-plane\n service-policy input COPP-POLICYMAP-EXAMPLE\n```","srcMarkdownNoYaml":"\n\n#### General Notes\n\n- Stands for **Control Plane Policing**\n- Used to protect the control plane of network equipment from being saturated with less preferred traffic, DOS attempts, etc\n- Policy-maps function in top-down fashion like ACLs\n- `class-default` will match all traffic not matched earlier in a policy-map\n- **Match any vs Match all**\n\t- Used in class-maps, behavior differenet when matching multiple access groups\n\t- Match any functions as boolean **OR**, match all functions as boolean **AND**\n\t\n---\n\n#### Useful show commands\n- `show policy-map control-plane input` - Verify number of packets hitting COPP policy\n\n---\n\n#### Standard CoPP Config\n```\n! Identify traffic with ACLs\n!\nip access-list extended COPP-ICMP-ACL-EXAMPLE\n permit udp any any range 33434 33463 ttl eq 1\n permit icmp any any unreachable\n permit icmp any any echo\n permit icmp any any echo-reply\n permit icmp any any ttl-exceeded\n exit\nip access-list extended COPP-MGMT-TRAFFIC-ACL-EXAMPLE\n permit udp any eq ntp any\n permit udp any any eq snmp\n permit tcp any any eq 22\n permit tcp any eq 22 any established\n permit tcp any any eq 23\n exit\nip access-list extended COPP-ROUTING-PROTOCOLS-ACL-EXAMPLE\n permit tcp any eq bgp any established\n permit eigrp any host 224.0.0.10\n permit ospf any host 224.0.0.5\n permit ospf any host 224.0.0.6\n permit pim any host 224.0.0.13\n permit igmp any any\n!\n! Create class maps to define traffic classes\n!\nclass-map match-all COPP-ICMP-CLASSMAP-EXAMPLE\n match access-group name COPP-ICMP-ACL-EXAMPLE\nclass-map match-all COPP-MGMT-TRAFFIC-CLASSMAP-EXAMPLE\n match access-group name COPP-MGMT-TRAFFIC-ACL-EXAMPLE\nclass-map match-all COPP-ROUTING-PROTOCOLS-CLASSMAP-EXAMPLE\n match access-group name COPP-ROUTING-PROTOCOLS-ACL-EXAMPLE\n!\n! Create policy map to define service policy\n!\npolicy-map COPP-POLICYMAP-EXAMPLE\n class COPP-MGMT-TRAFFIC-CLASSMAP-EXAMPLE\n  police 32000 conform-action transmit exceed-action transmit violate-action transmit\n class COPP-ROUTING-PROTOCOLS-CLASSMAP-EXAMPLE\n  police 34000 conform-action transmit exceed-action transmit violate-action transmit\n class COPP-ICMP-CLASSMAP-EXAMPLE\n  police 8000 conform-action transmit exceed-action transmit violate-action drop\n!\n! Apply policy to control plane\n!\ncontrol-plane\n service-policy input COPP-POLICYMAP-EXAMPLE\n```"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["quarto"],"toc":true,"toc-depth":5,"css":["styles.css"],"output-file":"CoPP.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","theme":"custom.scss","fontsize":"1.1em","monocolor":"#2a9891","monobackgroundcolor":"#343a40","code-block-background":"#343a40","code-block-border-left":"#72c9d1","title":"CoPP","editor_options":{"markdown":{"mode":"gfm"}}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}